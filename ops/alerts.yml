groups:
  - name: tessrax-governance-alerts
    rules:
      - alert: HighReceiptLatency
        expr: histogram_quantile(0.95, sum(rate(receipt_latency_seconds_bucket[5m])) by (le)) > 0.5
        for: 2m
        labels:
          severity: warning
        annotations:
          summary: "High receipt latency (P95 > 500ms)"
          description: "Check backlog or database I/O saturation."
      - alert: QueueDepthHigh
        expr: queue_depth_ratio > 0.7
        for: 1m
        labels:
          severity: warning
        annotations:
          summary: "Queue depth > 70%."
          description: "Consider scaling reconciliation workers."
      - alert: IntegrityDriftDetected
        expr: integrity_score_drift > 0.02
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "Integrity drift exceeding normal window."
          description: "Potential cascade condition. Inspect latest receipts."
      - alert: ByzantineRootMismatch
        expr: federation_root_mismatch_total > 0
        for: 0m
        labels:
          severity: critical
        annotations:
          summary: "Federation Merkle root mismatch detected."
          description: "At least one node diverged. Run verify consensus."
      - alert: KeyRotationOverdue
        expr: key_rotation_age_days > 30
        for: 0m
        labels:
          severity: critical
        annotations:
          summary: "Signing key rotation overdue."
          description: "Run KeyVault.rotate_key() and verify receipt."
